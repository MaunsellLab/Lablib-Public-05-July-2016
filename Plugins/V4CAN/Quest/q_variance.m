/****************** FUNCTION DESCRIPTION ********************USAGE	double value;	value = q_variance(qc); ARGUMENTS	qc - Pointer to a conditionSUMMARY	Returns the variance of the values in the p array.RETURN VALUE	Returns a double.COMMENTS	See the document "Documentation to Supplement q_stats.c"for explanations of the algorithmns used below.REVISION HISTORY	11/87 EJ Chichilnisky	9/1/91	dgp	optimized so that the key loop uses registers for everything.************************************************************************/#include "q_include.h"#if THINK_C	#pragma options(global_optimizer,gopt_induction,gopt_cse,gopt_loop,gopt_coloring)	#pragma options(defer_adjust,redundant_loads,assign_registers,honor_register)#endifdouble q_variance(QCondition *qc){	register int i;	register double iF,x,*p,mean,variance;		variance=mean=0.0;	iF=i=qc->nLevels-1;	p=&qc->p[i];	for(;i>=0;i--) {		iF--;		x=*p--;		x*=iF;		mean+=x;		x*=iF;		variance+=x;	}	mean/=qc->now.pTotal;	variance/=qc->now.pTotal;	variance-=mean*mean;	variance*=qc->grain*qc->grain;	/* Convert to intensity. */	return variance;}