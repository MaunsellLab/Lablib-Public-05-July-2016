/***************************************************************USAGE	double entropy;		entropy = q_entropy(qc);ARGUMENTS	qc - pointer to a condition.SUMMARY	Returns the entropy of the p array.RETURN VALUE	Returns a double	COMMENTS	This routine is a serious bottleneck.	HISTORY	11/87		EJ Chichilnisky	9/1/91	dgp	optimized so that the key loop uses registers for everything.***********************************************************/#include "q_include.h"#if THINK_C	/* Using the log() that's intrinsic to the math chip is MUCH faster */	#define log(x) _log(x)	#pragma options(global_optimizer,gopt_induction,gopt_cse,gopt_loop,gopt_coloring)	#pragma options(defer_adjust,redundant_loads,assign_registers,honor_register)#endifdouble q_entropy(QCondition *qc){	register int i;					register double entropy,P,*p;		entropy=0.0;	p=qc->p;	i=qc->nLevels;	while (i--) {		P=*p++;		if(P>0.0)entropy+=P*log(P);	}	entropy/=-LN2*qc->now.pTotal;	entropy+=log(qc->now.pTotal)/LN2;	return entropy;}