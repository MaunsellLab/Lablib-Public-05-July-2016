/***************************************************************USAGE	double mean;		mean = q_mean(qc);ARGUMENTS	qc - pointer to a condition.SUMMARY	Returns the mean value of the p array.RETURN VALUE	Returns a double.	COMMENTS	For speed, the mean of the index of the p array is	calculated, and the return parameter then	gets passed to the macro itov(). No error-checking is done.	HISTORY	11/87		EJ Chichilnisky	12/8/91		dgp		Rewrote it for clarity. Function is unchanged.***********************************************************/#include "q_include.h"double q_mean(QCondition *qc){		register int i;	register double index,*p,mean;		mean=0.0;	index=i=qc->nLevels-1;	p=&qc->p[i];	for(;i>=0;i--){		mean+=index*(*p);		index--;		p--;	}	mean/=qc->now.pTotal;	mean=itov(qc,mean);	/* Convert to intensity. See q_include.h */	return(mean);}