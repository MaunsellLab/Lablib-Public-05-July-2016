/****************** FUNCTION DESCRIPTION ********************USAGE	double intensity;	intensity = q_mode(qc);ARGUMENTS	qc - ConditionSUMMARY	Returns a signal level for placement of the next trial of this condition.RETURN VALUE	Returns a double.ERROR HANDLING & BOUNDARY CONDITIONS	Range of intensity returned is determined by the number of levels, the estimated level, and grain for this condition.COMMENTS	The intensity returned is an estimate of (threshold + epsilon), which is therecommendation for most efficient trial placement. 	The return intensity will be an estimate of threshold if epsilon = 0.0, buttrial placement will be most efficient only when epsilon is computed asdirected in [Watson & Pelli].REVISION HISTORY	9/85		Version 1, A. B. Watson and K. Baldwin	10/16/86	Version 2; changed return level to intensity A. Fitzhugh	11/6/87	FW: use double vars everywhere; receive (QCondition *) qc				instead of cond;	8/10/94 dgp Fixed bug, discovered by Metrowerks CodeWarrior compiler.	We were initializing pMax to qc->p[i] instead of qc->p[0], even though	i was not initialized.*************************************************************/#include		<stdio.h>#include		"q_include.h"double q_mode(QCondition *qc){	double pMax;	int i,iMax;		iMax=0;	pMax=qc->p[0];	for (i=0; i<qc->nLevels; i++) {		if (pMax<qc->p[i]) {			iMax=i;			pMax=qc->p[i];		}	}	return(itov(qc,iMax));		/* return intensity */}